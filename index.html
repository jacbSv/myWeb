<!doctype html>
<html>
	<head>
		<title>LENOVO 81HX</title>
		<script src="Chart.min.js"></script>
		<script src="utils.js"></script>
		<style>
		canvas {
			-moz-user-select: none;
			-webkit-user-select: none;
			-ms-user-select: none;
				}
		</style>
	</head>
<body ><center>
	<div id="canvas-holder" style="width:50%">
		<canvas id="chart-area"></canvas>
	</div>
	<script>	
		Chart.defaults.doughnut = Chart.helpers.clone(Chart.defaults.doughnut);
		var helpers = Chart.helpers;
		var defaults = Chart.defaults;
		Chart.controllers.doughnut = Chart.controllers.doughnut.extend({
			updateElement: function(arc, index, reset) {
			var _this = this;
			var chart = _this.chart,
				chartArea = chart.chartArea,
				opts = chart.options,
				animationOpts = opts.animation,
				arcOpts = opts.elements.arc,
				centerX = (chartArea.left + chartArea.right) / 2,
				centerY = (chartArea.top + chartArea.bottom) / 2,
				startAngle = opts.rotation, // non reset case handled later
				endAngle = opts.rotation, 	// non reset case handled later
				dataset = _this.getDataset(),
				circumference = reset && animationOpts.animateRotate ? 0 : arc.hidden ? 0 : _this.calculateCircumference(dataset.data[index]) * (opts.circumference / (2.0 * Math.PI)),
				innerRadius = reset && animationOpts.animateScale ? 0 : _this.innerRadius,
				outerRadius = reset && animationOpts.animateScale ? 0 : _this.outerRadius,
				custom = arc.custom || {},
				valueAtIndexOrDefault = helpers.getValueAtIndexOrDefault;

			helpers.extend(arc, {
			  // Utility
			  _datasetIndex: _this.index,
			  _index: index,

			  // Desired view properties
			  _model: {
				x: centerX + chart.offsetX,
				y: centerY + chart.offsetY,
				startAngle: startAngle,
				endAngle: endAngle,
				circumference: circumference,
				outerRadius: outerRadius,
				innerRadius: innerRadius,
				label: valueAtIndexOrDefault(dataset.label, index, chart.data.labels[index])
					},

			  draw: function () {
				var ctx = this._chart.ctx,
								vm = this._view,
								sA = vm.startAngle,
								eA = vm.endAngle,
								opts = this._chart.config.options;						
							var labelPos = this.tooltipPosition();
							var segmentLabel = vm.circumference / opts.circumference * 100;
							
							ctx.beginPath();							
							ctx.arc(vm.x, vm.y, vm.outerRadius, sA, eA);
							ctx.arc(vm.x, vm.y, vm.innerRadius, eA, sA, true);
							
							ctx.closePath();
							ctx.strokeStyle = vm.borderColor;
							ctx.lineWidth = vm.borderWidth;							
							ctx.fillStyle = vm.backgroundColor;
							
							ctx.fill();
							ctx.lineJoin = 'bevel';
							
							if (vm.borderWidth) {
								ctx.stroke();
												}							
							if (vm.circumference > 0.15) { 		// Trying to hide label when it doesn't fit in segment
								ctx.beginPath();
								ctx.font = helpers.fontString(opts.defaultFontSize, opts.defaultFontStyle, opts.defaultFontFamily);
								ctx.fillStyle = "#fff";
								ctx.textBaseline = "top";
								ctx.textAlign = "center";
					
								// Round percentage in a way that it always adds up to 100%
								ctx.fillText(segmentLabel.toFixed(0) + "%", labelPos.x, labelPos.y);
														}
								}
							});
			var model = arc._model;
			model.backgroundColor = custom.backgroundColor ? custom.backgroundColor : valueAtIndexOrDefault(dataset.backgroundColor, index, arcOpts.backgroundColor);
			model.hoverBackgroundColor = custom.hoverBackgroundColor ? custom.hoverBackgroundColor : valueAtIndexOrDefault(dataset.hoverBackgroundColor, index, arcOpts.hoverBackgroundColor);
			model.borderWidth = custom.borderWidth ? custom.borderWidth : valueAtIndexOrDefault(dataset.borderWidth, index, arcOpts.borderWidth);
			model.borderColor = custom.borderColor ? custom.borderColor : valueAtIndexOrDefault(dataset.borderColor, index, arcOpts.borderColor);

			// Set correct angles if not resetting
			if (!reset || !animationOpts.animateRotate) {
			  if (index === 0) {
				model.startAngle = opts.rotation;
				} else {
				model.startAngle = _this.getMeta().data[index - 1]._model.endAngle;
						}
			  model.endAngle = model.startAngle + model.circumference;
					}
					arc.pivot();
		  }
		});
					// Valores del Grafico 		
		var config = {
		type: 'doughnut',			
			data:	{
				datasets: [{
					data: [241, 315], 
					backgroundColor: [window.chartColors.green, window.chartColors.red,], 
					label: 'MINED' }],
				labels: ['CE Completados','CE Faltantes',]
					},			
			options:{
				responsive: true,
				legend: {position: 'left',},
				title: {display: true, text: 'SEGUIMIENTO A 556 CE | CLONACION EQUIPOS LENOVO 81 HX'},
				animation: { animateScale:  true, animateRotate: true,}
					}
					};			

			window.onload = function() {
			var ctx = document.getElementById('chart-area').getContext('2d');
			window.myDoughnut = new Chart(ctx, config);
										};
	</script>
<br>
	<div id="canvas-holder" style="width:50%">
	<canvas id="bar-chart-horizontal" width="800" height="450"></canvas>
	</div>
	<script>
		new Chart(document.getElementById("bar-chart-horizontal"), {
			type: 'horizontalBar',
			data: 	{
				  labels: ["Ahuachapan", "Sonsonate", "Santa Ana", "La Libertad", "San Salvador", "Chalatenango", "Cuscatlan", "Caba√±as", "La Paz", "San Vicente", "Usulutan", "San Miguel", "Morazan", "La Union"],
				  datasets: [{
						  label: "Porcentaje",
						  backgroundColor: ["#3cb97d", "#3cb97d","#3cb97d","#3cb97d","#3cb97d","#3cb97d", "#3cb97d","#3cb97d","#3cb97d","#3cb97d","#3cb97d", "#3cb97d","#3cb97d","#3cb97d",],
						  data: [56,59,21,49,8,49,100,96,37,100,63,18,39,21]
							}]
					},
			options: {
				  responsive: true,
				  legend: 	{ display: true },
				  title: 	{ display: true, text: '% Seguimiento por Departamentos' }
					}
		});
	</script>

	<div id="canvas-holder" style="width:50%">
		<canvas id="ahuachapan-chart"></canvas>
	</div>
<script>		
	//	new Chart(document.getElementById("ahuachapan-chart"), {
	//				type: 'doughnut',					
	//				data: {
	//					labels: ['CE Completados','CE Faltantes'],					
	//					datasets: [{
	//						data: [18,14], 
	//						backgroundColor: ['#303030', window.chartColors.red,], 
	//						label: 'MINED' }]
	//						},					
	//				options: {
	//					responsive: true,
	//					legend: {position: 'left',},
	//					title: {display: true,text: 'Ahuachapan | 32 CE'},
	//					animation: {
	//					animateScale:  true,
	//					animateRotate: true
	//								}
	//						}
	//	});		
</script>	



		<div id="canvas-holder" style="width:50%">
				<canvas id="myChart2"></canvas>
			</div>
		<script>		
			var chartData = {
    labels: ["January", "February", "March", "April", "May", "Junio"],
    datasets: [
        {
            fillColor: "#79D1CF",
            strokeColor: "#79D1CF",
            data: [60, 80, 81, 56, 60, 90]
        }
    ]
};

var barOptions = {
  events: false,
	showTooltips: false,
	animation: {
    duration: 500,
    easing: "easeOutQuart",
    onComplete: function () {
        var ctx = this.chart.ctx;
        ctx.font = Chart.helpers.fontString(Chart.defaults.global.defaultFontFamily, 'normal', Chart.defaults.global.defaultFontFamily);
        ctx.textAlign = 'left';
        ctx.textBaseline = 'bottom';
        
        this.data.datasets.forEach(function (dataset) {
            console.log(dataset);
            for (var i = 0; i < dataset.data.length; i++) {
                var model = dataset._meta[Object.keys(dataset._meta)[0]].data[i]._model,
                    scale_max = dataset._meta[Object.keys(dataset._meta)[0]].data[i]._yScale.maxHeight;
                    left = dataset._meta[Object.keys(dataset._meta)[0]].data[i]._xScale.left;
                    offset = dataset._meta[Object.keys(dataset._meta)[0]].data[i]._xScale.longestLabelWidth;
                ctx.fillStyle = '#444';
                var y_pos = model.y - 5;
                var label = model.label;
                // Make sure data value does not get overflown and hidden
                // when the bar's value is too close to max value of scale
                // Note: The y value is reverse, it counts from top down
                if ((scale_max - model.y) / scale_max >= 0.93)
                    y_pos = model.y + 20; 
                // ctx.fillText(dataset.data[i], model.x, y_pos);
                ctx.fillText(label, left + 60, model.y + 8);
            }
        });               
    }
	}
};

var ctx = document.getElementById("myChart2").getContext("2d");
var myBar = new Chart(ctx, {
                type: 'horizontalBar',
                data: chartData,
                options: barOptions
            });
		</script>
	
</body>

</html>
